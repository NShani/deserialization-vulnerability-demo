package handler;

import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.nio.file.Files;
import java.nio.file.Paths;

public class JacksonDatabindDeserializer {

    public static void main(String[] args) throws Exception {
        JacksonDatabindDeserializer illegalTypesCheckTest = new JacksonDatabindDeserializer();
        illegalTypesCheckTest.deserialize();
    }

    public void deserialize() throws Exception {
        //read json file data
        byte[] jsonData = Files.readAllBytes(Paths.get("src/main/resources/student.json"));

        ObjectMapper mapper = new ObjectMapper();

        //enable global polymorphic type handling
        mapper.enableDefaultTyping();
        try {
            //deserializing the byte array to the given object
            Student student = mapper.readValue(jsonData, Student.class);

            System.out.println("Student name : " + student.name);
        } catch (JsonMappingException e) {
            System.out.println("Prevented for security reasons\n :" + e);
        }
    }

    static class Student {
        public int id;
        public String name;
        public Object obj;
    }
}